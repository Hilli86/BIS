{% extends "layout/base.html" %}

{% block styles %}
<style>
    .calculator-container {
        max-width: 400px;
        margin: 0 auto;
        touch-action: manipulation; /* Verhindert Double-Tap-Zoom f√ºr den gesamten Container */
    }
    
    .calculator-display {
        width: 100%;
        font-size: 2rem;
        text-align: right;
        padding: 1rem;
        border: 2px solid #dee2e6;
        border-radius: 0.5rem;
        background-color: #fff;
        margin-bottom: 1rem;
        min-height: 70px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        touch-action: manipulation; /* Verhindert Double-Tap-Zoom auch beim Display */
        user-select: none; /* Verhindert Textauswahl beim schnellen Tippen */
    }
    
    .calculator-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.5rem;
    }
    
    .calculator-button {
        font-size: 1.5rem;
        padding: 1rem;
        border: 2px solid #dee2e6;
        border-radius: 0.5rem;
        background-color: #fff;
        cursor: pointer;
        transition: all 0.2s;
        min-height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        touch-action: manipulation; /* Verhindert Double-Tap-Zoom */
        -webkit-tap-highlight-color: transparent; /* Entfernt Tap-Highlight */
    }
    
    .calculator-button:hover {
        background-color: #e9ecef;
        border-color: #adb5bd;
    }
    
    .calculator-button:active {
        background-color: #dee2e6;
        transform: scale(0.95);
    }
    
    .calculator-button.clear {
        background-color: #dc3545;
        color: white;
        border-color: #dc3545;
    }
    
    .calculator-button.clear:hover {
        background-color: #c82333;
        border-color: #bd2130;
    }
    
    .calculator-button.submit {
        grid-column: span 3;
        background-color: #0d6efd;
        color: white;
        border-color: #0d6efd;
        font-size: 1.2rem;
    }
    
    .calculator-button.submit:hover {
        background-color: #0b5ed7;
        border-color: #0a58ca;
    }
    
    .calculator-button.submit:disabled {
        background-color: #6c757d;
        border-color: #6c757d;
        cursor: not-allowed;
    }
    
    /* Mobile Optimierung */
    @media (max-width: 576px) {
        .calculator-display {
            font-size: 1.8rem;
            padding: 0.8rem;
            min-height: 60px;
        }
        
        .calculator-button {
            font-size: 1.3rem;
            padding: 0.8rem;
            min-height: 55px;
        }
        
        .calculator-button.submit {
            font-size: 1.1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<h1 class="mb-4">üîç Suche Thema</h1>

<div class="card shadow-sm mb-4">
    <div class="card-body">
        <form method="GET" action="{{ url_for('schichtbuch.suche_thema') }}" id="searchForm">
            <div class="calculator-container">
                <div class="calculator-display" id="display">0</div>
                
                <div class="calculator-buttons">
                    <button type="button" class="calculator-button" data-number="1">1</button>
                    <button type="button" class="calculator-button" data-number="2">2</button>
                    <button type="button" class="calculator-button" data-number="3">3</button>
                    <button type="button" class="calculator-button" data-number="4">4</button>
                    <button type="button" class="calculator-button" data-number="5">5</button>
                    <button type="button" class="calculator-button" data-number="6">6</button>
                    <button type="button" class="calculator-button" data-number="7">7</button>
                    <button type="button" class="calculator-button" data-number="8">8</button>
                    <button type="button" class="calculator-button" data-number="9">9</button>
                    <button type="button" class="calculator-button clear" id="clearBtn">C</button>
                    <button type="button" class="calculator-button" data-number="0">0</button>
                    <button type="button" class="calculator-button" id="backspaceBtn">‚å´</button>
                    <button type="submit" class="calculator-button submit" id="submitBtn" disabled>Weiter ‚Üí</button>
                </div>
                
                <input type="hidden" name="thema_id" id="themaIdInput" value="">
            </div>
        </form>
    </div>
</div>

<div class="mb-3">
    <a href="{{ url_for('schichtbuch.themaliste') }}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Zur√ºck zur Themenliste
    </a>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const display = document.getElementById('display');
    const themaIdInput = document.getElementById('themaIdInput');
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');
    const backspaceBtn = document.getElementById('backspaceBtn');
    const numberButtons = document.querySelectorAll('.calculator-button[data-number]');
    
    let currentValue = '';
    
    function updateDisplay() {
        if (currentValue === '') {
            display.textContent = '0';
            submitBtn.disabled = true;
        } else {
            display.textContent = currentValue;
            submitBtn.disabled = false;
        }
        themaIdInput.value = currentValue;
    }
    
    // Zahl-Buttons
    numberButtons.forEach(button => {
        button.addEventListener('click', function() {
            const number = this.getAttribute('data-number');
            currentValue += number;
            updateDisplay();
        });
    });
    
    // Clear-Button
    clearBtn.addEventListener('click', function() {
        currentValue = '';
        updateDisplay();
    });
    
    // Backspace-Button
    backspaceBtn.addEventListener('click', function() {
        if (currentValue.length > 0) {
            currentValue = currentValue.slice(0, -1);
            updateDisplay();
        }
    });
    
    // Tastatur-Unterst√ºtzung
    document.addEventListener('keydown', function(e) {
        if (e.key >= '0' && e.key <= '9') {
            currentValue += e.key;
            updateDisplay();
        } else if (e.key === 'Backspace') {
            e.preventDefault();
            if (currentValue.length > 0) {
                currentValue = currentValue.slice(0, -1);
                updateDisplay();
            }
        } else if (e.key === 'Escape' || e.key === 'Delete') {
            currentValue = '';
            updateDisplay();
        } else if (e.key === 'Enter') {
            if (currentValue !== '') {
                document.getElementById('searchForm').submit();
            }
        }
    });
    
    // Initialisierung
    updateDisplay();
});
</script>
{% endblock %}

